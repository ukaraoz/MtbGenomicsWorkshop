
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Pre-assembly Quality Control &#8212; M. tuberculosis Bioinformatics Workshop 0.1 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Assembly" href="assembly.html" />
    <link rel="prev" title="Read Quality Control and Trimming" href="read_qc.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="assembly.html" title="Assembly"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="read_qc.html" title="Read Quality Control and Trimming"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">M. tuberculosis Bioinformatics Workshop 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Day 1</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="pre-assembly-quality-control">
<h1>Pre-assembly Quality Control<a class="headerlink" href="#pre-assembly-quality-control" title="Permalink to this headline">¶</a></h1>
<p>Before running <code class="docutils literal notranslate"><span class="pre">sga</span> <span class="pre">preqc</span></code>, we need to <em>interleave</em> <em>forward</em> and <em>reverse</em> reads into a single file. <em>Interleaving</em> reads mean rearranging <em>forward</em> and <em>reverse</em> reads into a single file, keeping the original order and for each pair writing <em>forward</em> read followed by the <em>reverse</em> read.</p>
<p>To interleave reads, we will use <code class="docutils literal notranslate"><span class="pre">seqtk</span></code> tool:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>seqtk mergepe $MYRESULTSDIR/qc/MTB_illumina20X_qced_R1.fastq $MYRESULTSDIR/qc/MTB_illumina20X_qced_R2.fastq &gt; $MYRESULTSDIR/qc/MTB_illumina20X_qced_R1R2.fastq
seqtk mergepe $MYRESULTSDIR/qc/MTB_illumina60X_qced_R1.fastq $MYRESULTSDIR/qc/MTB_illumina60X_qced_R2.fastq &gt; $MYRESULTSDIR/qc/MTB_illumina60X_qced_R1R2.fastq
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">sga</span></code> computations will take several hours on a single core for the 60X library. To save time, we won’t be doing these computations but simply copy the results from the precalculated directory. Here is how to do these computations (<strong>DONOT RUN</strong>).</p>
<p>First, index the data using <code class="docutils literal notranslate"><span class="pre">sga</span> <span class="pre">index</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>sga index -t 4 -a ropebwt $MYRESULTSDIR/qc/MTB_illumina20X_qced_R1R2.fastq
sga index -t 4 -a ropebwt $MYRESULTSDIR/qc/MTB_illumina60X_qced_R1R2.fastq
</pre></div>
</div>
<p>Run <em>sga preqc</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>sga preqc -t 4 $MYRESULTSDIR/qc/MTB_illumina20X_qced_R1R2.fastq &gt; $MYRESULTSDIR/qc/MTB_illumina20X_qced_R1R2.preqc
sga preqc -t 4 $MYRESULTSDIR/qc/MTB_illumina60X_qced_R1R2.fastq &gt; $MYRESULTSDIR/qc/MTB_illumina60X_qced_R1R2.preqc
</pre></div>
</div>
<p>Copy the precalculated results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cp /home/mtb_upm/mtb_genomics_workshop_data/genome-assembly-annotation/precalculated/MTB_illumina20X_qced_R1R2.preqc $MYRESULTSDIR/qc
cp /home/mtb_upm/mtb_genomics_workshop_data/genome-assembly-annotation/precalculated/MTB_illumina60X_qced_R1R2.preqc $MYRESULTSDIR/qc
</pre></div>
</div>
<p>Make the report:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sga</span><span class="o">-</span><span class="n">preqc</span><span class="o">-</span><span class="n">report</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">P</span> <span class="n">genome_size</span> \
<span class="o">-</span><span class="n">P</span> <span class="n">branch_classification_error</span> <span class="o">-</span><span class="n">P</span> <span class="n">branch_classification_repeat</span> <span class="o">-</span><span class="n">P</span> <span class="n">branch_classification_variant</span> \
<span class="o">-</span><span class="n">P</span> <span class="n">de_bruijn_simulation_lengths</span> <span class="o">-</span><span class="n">P</span> <span class="n">kmer_distribution</span> <span class="o">-</span><span class="n">P</span> <span class="n">gc_distribution</span> <span class="o">-</span><span class="n">P</span> <span class="n">fragment_sizes</span> \
<span class="n">MTB_illumina20X_qced_R1R2</span><span class="o">.</span><span class="n">preqc</span> <span class="n">MTB_illumina60X_qced_R1R2</span><span class="o">.</span><span class="n">preqc</span> <span class="o">-</span><span class="n">o</span> <span class="n">sga</span><span class="o">-</span><span class="n">preqc</span><span class="o">-</span><span class="n">report</span><span class="o">.</span><span class="n">pdf</span>
</pre></div>
</div>
<p>Open the PDF report and interpret the results.</p>
<p>Questions:
* Was the genome size estimated correctly?
* What differences do you observe between the 20x (blue) and the 60X (red) datasets?
* Which library will be easier to assemble?</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="read_qc.html"
                        title="previous chapter">Read Quality Control and Trimming</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="assembly.html"
                        title="next chapter">Assembly</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/day1/preassembly_qc.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="assembly.html" title="Assembly"
             >next</a> |</li>
        <li class="right" >
          <a href="read_qc.html" title="Read Quality Control and Trimming"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">M. tuberculosis Bioinformatics Workshop 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Day 1</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Ulas Karaoz.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>